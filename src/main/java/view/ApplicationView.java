/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package view;

import dao.FuncionarioDao;
import entities.Funcionario;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.Date;
import java.util.Optional;
import javax.swing.JOptionPane;
import org.hibernate.SessionFactory;
import utils.Criptografar;
import utils.HibernateUtil;
import utils.VisualsConfig;

/**
 *
 * @author evely
 */
public class ApplicationView extends javax.swing.JFrame {

    /**
     * Creates new form ApplicationView
     */
    public ApplicationView() {
        initComponents();
        
        pnlcadastrarfunc.setVisible(true);
        pnlcadastros.setVisible(false);
 
        VisualsConfig.setPropsToWindow(this, "Cadastro de Funcion√°rio", tfdatividade);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        background = new javax.swing.JPanel();
        pnlmenulateral = new javax.swing.JPanel();
        btnhome = new javax.swing.JButton();
        btncadastro = new javax.swing.JButton();
        barralateral = new javax.swing.JLabel();
        pnlhome = new javax.swing.JPanel();
        pnlcadastrarfunc = new javax.swing.JPanel();
        tfddata = new com.toedter.calendar.JDateChooser();
        btncadastrar = new javax.swing.JButton();
        tfdsenha = new javax.swing.JPasswordField();
        tfdstatus = new javax.swing.JTextField();
        tfdsexo = new javax.swing.JTextField();
        tfdcpf = new javax.swing.JTextField();
        tfdtelefone = new javax.swing.JTextField();
        tfdemail = new javax.swing.JTextField();
        tfdcidade = new javax.swing.JTextField();
        tfdestado = new javax.swing.JTextField();
        tfdatividade = new javax.swing.JTextField();
        tfdnome = new javax.swing.JTextField();
        tfdusuario = new javax.swing.JTextField();
        cadastroform = new javax.swing.JLabel();
        pnlcadastros = new javax.swing.JPanel();
        tfdbusca = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        tabelalist = new javax.swing.JTable();
        btnbuscar = new javax.swing.JButton();
        btnadicionar = new javax.swing.JButton();
        backgroundcadastro = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        background.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        pnlmenulateral.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        btnhome.setBackground(new java.awt.Color(58, 203, 199));
        btnhome.setForeground(new java.awt.Color(58, 203, 199));
        btnhome.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/home.png"))); // NOI18N
        btnhome.setBorder(null);
        btnhome.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnhomeActionPerformed(evt);
            }
        });
        pnlmenulateral.add(btnhome, new org.netbeans.lib.awtextra.AbsoluteConstraints(13, 180, 140, 50));

        btncadastro.setBackground(new java.awt.Color(58, 203, 199));
        btncadastro.setForeground(new java.awt.Color(58, 203, 199));
        btncadastro.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/iconcadastro.png"))); // NOI18N
        btncadastro.setBorder(null);
        btncadastro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncadastroActionPerformed(evt);
            }
        });
        pnlmenulateral.add(btncadastro, new org.netbeans.lib.awtextra.AbsoluteConstraints(14, 250, 140, 50));

        barralateral.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/barralateral.png"))); // NOI18N
        pnlmenulateral.add(barralateral, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, -1));

        background.add(pnlmenulateral, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 160, 700));

        javax.swing.GroupLayout pnlhomeLayout = new javax.swing.GroupLayout(pnlhome);
        pnlhome.setLayout(pnlhomeLayout);
        pnlhomeLayout.setHorizontalGroup(
            pnlhomeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1040, Short.MAX_VALUE)
        );
        pnlhomeLayout.setVerticalGroup(
            pnlhomeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 700, Short.MAX_VALUE)
        );

        background.add(pnlhome, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 0, 1040, 700));

        pnlcadastrarfunc.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        tfddata.setBackground(new java.awt.Color(218, 218, 218));
        tfddata.setToolTipText("");
        pnlcadastrarfunc.add(tfddata, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 490, 340, 30));

        btncadastrar.setBackground(new java.awt.Color(58, 203, 199));
        btncadastrar.setFont(new java.awt.Font("Poppins", 0, 16)); // NOI18N
        btncadastrar.setForeground(new java.awt.Color(255, 255, 255));
        btncadastrar.setText("Cadastrar");
        btncadastrar.setBorder(null);
        btncadastrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncadastrarActionPerformed(evt);
            }
        });
        pnlcadastrarfunc.add(btncadastrar, new org.netbeans.lib.awtextra.AbsoluteConstraints(770, 630, 140, 40));

        tfdsenha.setBackground(new java.awt.Color(218, 218, 218));
        tfdsenha.setToolTipText("");
        tfdsenha.setBorder(null);
        pnlcadastrarfunc.add(tfdsenha, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 320, 320, 30));

        tfdstatus.setBackground(new java.awt.Color(218, 218, 218));
        tfdstatus.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdstatus.setToolTipText("");
        tfdstatus.setBorder(null);
        pnlcadastrarfunc.add(tfdstatus, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 160, 320, 30));

        tfdsexo.setBackground(new java.awt.Color(218, 218, 218));
        tfdsexo.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdsexo.setToolTipText("");
        tfdsexo.setBorder(null);
        pnlcadastrarfunc.add(tfdsexo, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 230, 320, 30));

        tfdcpf.setBackground(new java.awt.Color(218, 218, 218));
        tfdcpf.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdcpf.setToolTipText("");
        tfdcpf.setBorder(null);
        pnlcadastrarfunc.add(tfdcpf, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 320, 320, 30));

        tfdtelefone.setBackground(new java.awt.Color(218, 218, 218));
        tfdtelefone.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdtelefone.setToolTipText("");
        tfdtelefone.setBorder(null);
        pnlcadastrarfunc.add(tfdtelefone, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 410, 320, 30));

        tfdemail.setBackground(new java.awt.Color(218, 218, 218));
        tfdemail.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdemail.setToolTipText("");
        tfdemail.setBorder(null);
        pnlcadastrarfunc.add(tfdemail, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 570, 320, 30));

        tfdcidade.setBackground(new java.awt.Color(218, 218, 218));
        tfdcidade.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdcidade.setToolTipText("");
        tfdcidade.setBorder(null);
        pnlcadastrarfunc.add(tfdcidade, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 570, 320, 30));

        tfdestado.setBackground(new java.awt.Color(218, 218, 218));
        tfdestado.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdestado.setToolTipText("");
        tfdestado.setBorder(null);
        pnlcadastrarfunc.add(tfdestado, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 490, 320, 30));

        tfdatividade.setBackground(new java.awt.Color(218, 218, 218));
        tfdatividade.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdatividade.setToolTipText("");
        tfdatividade.setBorder(null);
        pnlcadastrarfunc.add(tfdatividade, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 410, 320, 30));

        tfdnome.setBackground(new java.awt.Color(218, 218, 218));
        tfdnome.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdnome.setToolTipText("");
        tfdnome.setBorder(null);
        pnlcadastrarfunc.add(tfdnome, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 160, 320, 30));

        tfdusuario.setBackground(new java.awt.Color(218, 218, 218));
        tfdusuario.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdusuario.setToolTipText("");
        tfdusuario.setBorder(null);
        pnlcadastrarfunc.add(tfdusuario, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 243, 320, 30));

        cadastroform.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/cadastroform.png"))); // NOI18N
        pnlcadastrarfunc.add(cadastroform, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, -1));

        background.add(pnlcadastrarfunc, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 0, 1040, 700));

        pnlcadastros.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        tfdbusca.setBackground(new java.awt.Color(218, 218, 218));
        tfdbusca.setFont(new java.awt.Font("Poppins", 0, 14)); // NOI18N
        tfdbusca.setText("Buscar");
        tfdbusca.setToolTipText("");
        tfdbusca.setBorder(null);
        pnlcadastros.add(tfdbusca, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 34, 670, 30));

        tabelalist.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(tabelalist);

        pnlcadastros.add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 120, 930, 480));

        btnbuscar.setBackground(new java.awt.Color(58, 203, 199));
        btnbuscar.setFont(new java.awt.Font("Poppins", 0, 13)); // NOI18N
        btnbuscar.setForeground(new java.awt.Color(255, 255, 255));
        btnbuscar.setText("Buscar");
        btnbuscar.setToolTipText("");
        btnbuscar.setBorder(null);
        pnlcadastros.add(btnbuscar, new org.netbeans.lib.awtextra.AbsoluteConstraints(860, 33, 100, 30));

        btnadicionar.setBackground(new java.awt.Color(230, 230, 230));
        btnadicionar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/add.png"))); // NOI18N
        btnadicionar.setToolTipText("");
        btnadicionar.setBorder(null);
        btnadicionar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnadicionarActionPerformed(evt);
            }
        });
        pnlcadastros.add(btnadicionar, new org.netbeans.lib.awtextra.AbsoluteConstraints(940, 630, 50, 40));

        backgroundcadastro.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/cadastrolist.png"))); // NOI18N
        pnlcadastros.add(backgroundcadastro, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, -1, -1));

        background.add(pnlcadastros, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 0, 1040, 700));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(background, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(background, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnhomeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnhomeActionPerformed
        pnlmenulateral.setVisible(true);
        pnlcadastrarfunc.setVisible(false);
        pnlcadastros.setVisible(false);
    }//GEN-LAST:event_btnhomeActionPerformed

    private void btncadastrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncadastrarActionPerformed
         SessionFactory sessionFactory = HibernateUtil.getSessionFactory();
        
        Funcionario funcionario = new Funcionario();
        funcionario.setNome(tfdnome.getText());
        funcionario.setSexo(tfdsexo.getText());
        funcionario.setCpf(tfdcpf.getText());
        funcionario.setTelefone(tfdtelefone.getText());
        funcionario.setEmail(tfdemail.getText());
        funcionario.setEndereco(tfdestado.getText());
        funcionario.setCidade(tfdcidade.getText());
        funcionario.setEstado(tfdestado.getText());
        funcionario.setData_nascimento(convertToLocalDate(tfddata.getDate()));
        funcionario.setData_cadastro(LocalDate.now());
        funcionario.setStatus(tfdstatus.getText());
        funcionario.setUsuario(tfdusuario.getText());
        char[] getSenha = tfdsenha.getPassword();
        String senha = String.valueOf(getSenha);
        funcionario.setSenha(Criptografar.encriptografar(senha));
        funcionario.setAtividade(tfdatividade.getText());
        
        FuncionarioDao fd = new FuncionarioDao(sessionFactory);
        Optional<Funcionario> funcOpt = fd.salvar(funcionario);
        if (funcOpt.isPresent()) {
            JOptionPane.showMessageDialog(null, "Funcion√°rio salvo com sucesso!");
        } else {
            JOptionPane.showMessageDialog(null, "Erro ao cadastrar funcion√°rio!");
        }
    }//GEN-LAST:event_btncadastrarActionPerformed

    private void btnadicionarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnadicionarActionPerformed
        pnlcadastrarfunc.setVisible(true);
        pnlhome.setVisible(false);
        pnlcadastros.setVisible(false);
    }//GEN-LAST:event_btnadicionarActionPerformed

    private void btncadastroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncadastroActionPerformed
        pnlhome.setVisible(false);
        pnlcadastrarfunc.setVisible(false);
        pnlcadastros.setVisible(true);
    }//GEN-LAST:event_btncadastroActionPerformed
    
    public LocalDate convertToLocalDate(Date dateToConvert) {
        return dateToConvert.toInstant()
                .atZone(ZoneId.systemDefault())
                .toLocalDate();
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ApplicationView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ApplicationView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ApplicationView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ApplicationView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ApplicationView().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel background;
    private javax.swing.JLabel backgroundcadastro;
    private javax.swing.JLabel barralateral;
    private javax.swing.JButton btnadicionar;
    private javax.swing.JButton btnbuscar;
    private javax.swing.JButton btncadastrar;
    private javax.swing.JButton btncadastro;
    private javax.swing.JButton btnhome;
    private javax.swing.JLabel cadastroform;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JPanel pnlcadastrarfunc;
    private javax.swing.JPanel pnlcadastros;
    private javax.swing.JPanel pnlhome;
    private javax.swing.JPanel pnlmenulateral;
    private javax.swing.JTable tabelalist;
    private javax.swing.JTextField tfdatividade;
    private javax.swing.JTextField tfdbusca;
    private javax.swing.JTextField tfdcidade;
    private javax.swing.JTextField tfdcpf;
    private com.toedter.calendar.JDateChooser tfddata;
    private javax.swing.JTextField tfdemail;
    private javax.swing.JTextField tfdestado;
    private javax.swing.JTextField tfdnome;
    private javax.swing.JPasswordField tfdsenha;
    private javax.swing.JTextField tfdsexo;
    private javax.swing.JTextField tfdstatus;
    private javax.swing.JTextField tfdtelefone;
    private javax.swing.JTextField tfdusuario;
    // End of variables declaration//GEN-END:variables
}
